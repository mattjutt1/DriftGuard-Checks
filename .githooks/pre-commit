#!/bin/bash
# Simple pre-commit hook to update knowledge graph

echo "üß† Updating knowledge graph..."

# Check if Python is available
if ! command -v python3 &> /dev/null; then
    echo "‚ö†Ô∏è  Python3 not found, skipping knowledge graph update"
    exit 0
fi

# Update knowledge graph if script exists
if [ -f ".claude/scripts/update_knowledge_graph.py" ]; then
    python3 .claude/scripts/update_knowledge_graph.py
    if [ $? -eq 0 ]; then
        echo "‚úÖ Knowledge graph updated"
        # Add updated files to commit if they exist
        if [ -f ".claude/knowledge_graph.json" ]; then
            git add .claude/knowledge_graph.json
        fi
        if [ -f ".claude/context_vectors.json" ]; then
            git add .claude/context_vectors.json  
        fi
    else
        echo "‚ö†Ô∏è  Knowledge graph update failed, continuing with commit"
    fi
else
    echo "‚ö†Ô∏è  Knowledge graph script not found, skipping update"
fi

exit 0