# Minimal working Ollama for Railway
FROM ollama/ollama:latest

# Install curl
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# Create a very simple startup script
RUN echo '#!/bin/bash\n\
set -ex\n\
\n\
# Debug environment\n\
echo "=== RAILWAY DEBUG ==="\n\
echo "PORT: ${PORT}"\n\
echo "HOME: ${HOME}"\n\
echo "PWD: $(pwd)"\n\
echo "USER: $(whoami)"\n\
echo "OLLAMA PATH: $(which ollama)"\n\
\n\
# Use Railway PORT or fallback\n\
SERVE_PORT=${PORT:-11434}\n\
export OLLAMA_HOST="0.0.0.0:${SERVE_PORT}"\n\
\n\
echo "Starting ollama on port $SERVE_PORT"\n\
\n\
# Start ollama and keep it in foreground for now\n\
exec ollama serve\n\
' > /start.sh && chmod +x /start.sh

CMD ["/start.sh"]